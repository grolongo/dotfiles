#!/usr/bin/env bash
set -e
set -u
set -o pipefail
IFS=$'\n\t'

# Note:
# also waiting for https://github.com/emersion/mako/pull/585 to be merged,
# mako will display 1x1 icon while dunst while show a proper size.

tmpfile=$(mktemp --suffix=.png); trap 'rm -f "$tmpfile"' EXIT

grim -g "$(slurp -p)" -t ppm "$tmpfile"
hex=$(magick "$tmpfile" -scale 1x1\! -format "#%[hex:p{0,0}]" info: 2>/dev/null || echo "#??????")
echo "$hex" | wl-copy && notify-send -i "$tmpfile" "$hex"
