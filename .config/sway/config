# xwayland disable
for_window [shell="xwayland"] title_format "[XWayland] %title"
#exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
exec_always autotiling
exec mako
exec synology-drive

set $mod  Mod4
set $term foot
set $menu tofi-drun --drun-launch=true
# emacs movements
set $left  b
set $down  n
set $up    p
set $right f

titlebar_padding 4 2

# ------------------
# Idle configuration
# ------------------

exec swayidle -w \
         timeout 300 swaylock \
         timeout 600 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' \
         timeout 1200 'systemctl suspend' \
         before-sleep swaylock

# ----------------------
# Input(s) configuration
# ----------------------

input type:keyboard {
    xkb_layout "fr"
    xkb_options ctrl:nocaps
    repeat_delay 150
    repeat_rate 50
}

input type:touchpad {
    dwt enabled              # "disabled while typing"
    tap enabled              # self explaining
    natural_scroll enabled   # "reverse scrolling"
    middle_emulation enabled # middle click emulation
    accel_profile "flat"     # "adaptive" to enable
    pointer_accel 0.5        # set mouse sensitivity (between -1 and 1)
    # scroll_factor
}

input type:pointer {
    dwt enabled              # "disabled while typing"
    natural_scroll enabled   # "reverse scrolling"
    accel_profile "flat"     # "adaptive" to enable
    pointer_accel 0.5        # set mouse sensitivity (between -1 and 1)
    # scroll_factor
}

# -----------------
# Window Management
# -----------------

# Workspaces
set $ws1 "1"
set $ws2 "2: Emacs"
set $ws3 "3: www"
set $ws4 "4: Tor"
set $ws5 "5: Spotify"
set $ws6 "6: KeePass"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# Assignments
assign [app_id="emacs"]         $ws2
assign [app_id="firefox"]       $ws3
assign [app_id="chromium"]      $ws3
assign [app_id="Tor Browser"]   $ws4
assign [app_id="Spotify"]       $ws5
assign [app_id="chatty-Chatty"] $ws6
assign [app_id="KeePassXC"]     $ws7

# Floating Apps
floating_modifier $mod normal
for_window [window_type="dialog"]   floating enable
for_window [window_role="dialog"]   floating enable
for_window [app_id="Tor Messenger"] floating enable
for_window [app_id="Krita"]         floating enable
for_window [app_id="VirtualBox"]    floating enable
for_window [app_id="Steam"]         floating enable
# for_window [app_id="KeePass"]       floating enable
for_window [app_id="Seafile"]       floating enable
for_window [app_id="Veracrypt"]     floating enable

# --------
# Bindings
# --------

bindsym $mod+Tab     workspace next
bindsym $mod+Return  exec $term
bindsym $mod+d       exec $menu
bindsym $mod+Shift+q kill
bindsym $mod+Shift+c reload
bindsym $mod+Shift+l exec swaylock
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

# Move your focus around
bindsym $mod+$left  focus left
bindsym $mod+$down  focus down
bindsym $mod+$up    focus up
bindsym $mod+$right focus right
# Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left  move left
bindsym $mod+Shift+$down  move down
bindsym $mod+Shift+$up    move up
bindsym $mod+Shift+$right move right

# Switch to workspace
bindsym $mod+ampersand  workspace number $ws1
bindsym $mod+eacute     workspace number $ws2
bindsym $mod+quotedbl   workspace number $ws3
bindsym $mod+apostrophe workspace number $ws4
bindsym $mod+parenleft  workspace number $ws5
bindsym $mod+minus      workspace number $ws6
bindsym $mod+egrave     workspace number $ws7
bindsym $mod+underscore workspace number $ws8
bindsym $mod+ccedilla   workspace number $ws9
bindsym $mod+agrave     workspace number $ws10

# Move focused container to workspace
bindsym $mod+Shift+1        move container to workspace number $ws1
bindsym $mod+Shift+eacute   move container to workspace number $ws2
bindsym $mod+Shift+3        move container to workspace number $ws3
bindsym $mod+Shift+4        move container to workspace number $ws4
bindsym $mod+Shift+5        move container to workspace number $ws5
bindsym $mod+Shift+6        move container to workspace number $ws6
bindsym $mod+Shift+egrave   move container to workspace number $ws7
bindsym $mod+Shift+8        move container to workspace number $ws8
bindsym $mod+Shift+ccedilla move container to workspace number $ws9
bindsym $mod+Shift+agrave   move container to workspace number $ws10

# Layout stuff
bindsym $mod+down        splith
bindsym $mod+right       splitv
bindsym $mod+s           layout   stacking
bindsym $mod+w           layout   tabbed
bindsym $mod+e           layout   toggle split
bindsym $mod+Shift+s     fullscreen
bindsym $mod+Shift+space floating toggle
bindsym $mod+space       focus    mode_toggle
bindsym $mod+a           focus    parent

# Scratchpad
# bindsym $mod+Shift+minus move scratchpad
# bindsym $mod+minus scratchpad show

# Resizing containers:
bindsym $mod+r mode "resize"
mode "resize" {
    bindsym $left  resize shrink width  10px
    bindsym $down  resize grow   height 10px
    bindsym $up    resize shrink height 10px
    bindsym $right resize grow   width  10px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Audio Controls
bindsym --locked XF86AudioMicMute     exec wpctl set-mute          \@DEFAULT_AUDIO_SOURCE@ toggle
bindsym --locked XF86AudioMute        exec wpctl set-mute          \@DEFAULT_AUDIO_SINK@   toggle
bindsym --locked XF86AudioLowerVolume exec wpctl set-volume        \@DEFAULT_AUDIO_SINK@   5%-
bindsym --locked XF86AudioRaiseVolume exec wpctl set-volume -l 1.5 \@DEFAULT_AUDIO_SINK@   5%+

# Multimedia Controls
bindsym --locked XF86AudioPlay  exec playerctl play-pause
bindsym --locked XF86AudioPause exec playerctl play-pause
bindsym --locked XF86AudioPrev  exec playerctl previous
bindsym --locked XF86AudioNext  exec playerctl next

# Screen Brightness Controls
bindsym XF86MonBrightnessDown exec "brightness down"
bindsym XF86MonBrightnessUp   exec "brightness up"

# Keyboard Brightness Controls
bindsym XF86KbdBrightnessDown exec "sudo keyboard-backlight down"
bindsym XF86KbdBrightnessUp   exec "sudo keyboard-backlight up"

# Special keys to take a screenshot with grim
bindsym print        exec grim "${HOME}"/Downloads/$(date +'%s_grim.png')
bindsym ctrl+print   exec grim -g "$(slurp)" "${HOME}"/Downloads/$(date +'%s_grim.png')
bindsym ctrl+c+print exec grim -g "$(slurp -p)" -t ppm - | convert - -format '%[pixel:p{0,0}]' txt:- | wl-copy

# ----------
# Status Bar
# ----------

exec waybar

# bar {
#     position bottom
#     status_command i3status

#     colors {
#         background #000000
#         statusline #ffffff
#         separator #666666

#         focused_workspace  #4c7899 #285577 #ffffff
#         active_workspace   #333333 #5f676a #ffffff
#         inactive_workspace #333333 #222222 #888888
#         urgent_workspace   #2f343a #900000 #ffffff
#         binding_mode       #2f343a #900000 #ffffff
#     }
# }

include @sysconfdir@/sway/config.d/*
